<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Birthday Journey for My Love</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --color-pink: #fad0c4;
      --color-pink2: #ffd1ff;
      --color-gold: #fff4e3;
      --color-sparkle: #ffe4ec;
      --color-heart: #f4c4d7;
      --color-bg-1: linear-gradient(135deg, #fad0c4 0%, #ffd1ff 100%);
      --color-bg-2: linear-gradient(135deg, #fff4e3 0%, #ffe4ec 100%);
      --color-card: #fff9f6;
      --color-shadow: rgba(255,182,193,0.12);

      --font-main: 'Inter', sans-serif;
      --font-script: 'Dancing Script', cursive;
    }
    html, body {
      height: 100%;
      margin: 0; padding: 0;
      font-family: var(--font-main);
      background: var(--color-bg-1);
      min-height: 100vh;
      scroll-behavior: smooth;
    }
    body {
      overflow-x: hidden;
    }
    .app-container {
      min-height: 100vh;
      width: 100vw;
    }
    .center-content {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      min-height: 70vh;
    }
    .main-title {
      font-family: var(--font-script);
      font-size: 2.8rem;
      color: #ff62a1;
      margin-bottom: 1rem;
      text-shadow: 1px 2px 8px #ffe4ec70;
      letter-spacing: 1px;
      animation: fadeInDown 2s cubic-bezier(.39,.58,.57,1);
    }
    .subtitle {
      font-size: 1.25rem;
      color: #7a5b64;
      margin-bottom: 2rem;
      letter-spacing: 0.5px;
      text-align: center;
      animation: fadeIn 3s cubic-bezier(.19,1,.22,1) 1s;
    }
    .primary-btn {
      padding: 0.85rem 2.5rem;
      background: linear-gradient(90deg, #ff8bc9, #ffc9ee);
      border: none;
      border-radius: 25px;
      color: #fff;
      font-family: var(--font-script);
      font-size: 1.5rem;
      letter-spacing: 0.5px;
      box-shadow: 0 6px 32px var(--color-shadow);
      cursor: pointer;
      margin-top: 2rem;
      transition: background .3s, transform .18s;
      position: relative;
      z-index: 1;
    }
    .primary-btn:hover {
      background: linear-gradient(90deg, #ffc9ee, #ff8bc9 80%);
      transform: scale(1.04);
    }
    .sparkles, .hearts {
      position: fixed;
      pointer-events: none;
      z-index: 9;
      top: 0; left: 0; width: 100vw; height: 100vh;
    }

    /* Gallery Page */
    .gallery-bg {
      background: var(--color-bg-2);
      min-height: 100vh;
      width: 100vw;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      padding-top: 40px;
    }
    .gallery-wrap {
      display: flex; flex-wrap: wrap;
      gap: 32px;
      max-width: 1100px;
      justify-content: center;
    }
    .polaroid {
      background: var(--color-card);
      border-radius: 16px;
      box-shadow: 0 6px 32px var(--color-shadow), 0 2px 8px #eed1e870;
      width: 210px;
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-bottom: 16px;
      padding-bottom: 12px;
      position: relative;
      animation: fadeInUp 2s;
      transition: transform .2s;
    }
    .polaroid:hover {
      transform: scale(1.04) rotate(-1deg);
      z-index: 2;
    }
    .polaroid-img {
      width: 200px;
      height: 220px;
      object-fit: cover;
      border-radius: 12px 12px 6px 6px;
      margin-top: 6px;
      box-shadow: 0 2px 12px #eee3e5;
    }
    .caption {
      font-size: 1.1rem;
      font-family: var(--font-script);
      color: #f2548b;
      margin-top: 8px;
      text-align: center;
      padding: 0 10px;
    }

    /* Love Letter Page */
    .letter-page {
      background: #fff4e3;
      min-height: 100vh;
      display: flex; align-items: center; justify-content: center;
      padding: 30px 0;
    }
    .letter-container {
      background: #fff9f6;
      border-radius: 20px;
      box-shadow: 0 8px 44px #eed1e8a0;
      padding: 40px 32px;
      max-width: 650px;
      margin: auto;
      position: relative;
      animation: fadeInDown 1.7s;
    }
    .parchment-bg {
      background: linear-gradient(135deg, #fffbe7 88%, #fde8e7 100%);
      border-radius: 20px;
      box-shadow: 0 4px 28px #eed1e8a0;
      padding: 36px 20px 20px 20px;
    }
    .love-letter {
      font-size: 1.24rem;
      font-family: var(--font-script);
      color: #a75be4;
      line-height: 1.62;
      letter-spacing: 0.2px;
      white-space: pre-line;
      text-shadow: 0 0 6px #fcdaec33;
    }

    /* Our Moments */
    .timeline-bg {
      background: linear-gradient(135deg, #fad0c4 0%, #fff4e3 100%);
      min-height: 100vh;
      padding: 42px 0 26px 0;
      display: flex; align-items: center; flex-direction: column;
      justify-content: flex-start;
    }
    .moments-timeline {
      width: 94vw; max-width: 780px;
      margin: 0 auto;
      background: #fff9f6bb;
      border-radius: 15px;
      box-shadow: 0 4px 24px #f5c3e690;
      padding: 38px 28px 24px 28px;
      backdrop-filter: blur(2px);
      margin-bottom: 22px;
      animation: fadeInUp 1.6s;
    }
    .timeline-event {
      margin-bottom: 24px;
      position: relative;
      padding-left: 28px;
    }
    .timeline-dot {
      position: absolute;
      left: 0; top: 7px;
      width: 14px; height: 14px;
      background: radial-gradient(circle, #e678be 60%, #fff 100%);
      border-radius: 50%;
      box-shadow: 0 0 8px #fc92d7b1;
    }
    .event-date {
      font-family: var(--font-main);
      font-size: 0.97rem;
      color: #a75be4;
      margin-bottom: 3px;
    }
    .event-desc {
      font-size: 1.13rem;
      color: #e6428c;
      font-family: var(--font-script);
    }
    .section-title {
      font-family: var(--font-script);
      font-size: 2.1rem;
      color: #e678be;
      margin-bottom: 16px;
      text-align: center;
    }
    .short-quotes {
      background: #fffbe7e8;
      border-radius: 12px;
      box-shadow: 0 1px 8px #efd9e555;
      margin: 30px auto;
      padding: 24px 20px 10px 20px;
      max-width: 520px;
      text-align: center;
      font-family: var(--font-script);
      color: #f66ca1;
      font-size: 1.23rem;
    }
    .future-box {
      background: #fef4e5ee;
      border-radius: 15px;
      box-shadow: 0 1px 11px #ecc2ea70;
      margin: 18px auto 0 auto;
      padding: 28px 18px;
      max-width: 480px;
      text-align: center;
      font-family: var(--font-script);
      color: #b26adb;
      font-size: 1.12rem;
      animation: fadeInUp 2s;
    }

    /* Final Birthday Page */
    .final-bg {
      background: linear-gradient(135deg, #ff8bc9 0%, #ffe2ea 100%);
      min-height: 100vh;
      width: 100vw;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      overflow: hidden;
      padding: 28px 0;
    }
    .final-card {
      background: #fff9f6dd;
      border-radius: 22px;
      box-shadow: 0 8px 44px #e678be34;
      padding: 54px 36px 36px 36px;
      max-width: 480px;
      margin: 40px auto 0 auto;
      position: relative;
      text-align: center;
    }
    .final-title {
      font-family: var(--font-script);
      font-size: 2.2rem;
      color: #e6428c;
      margin-bottom: 1rem;
      letter-spacing: 1px;
    }
    .final-note {
      font-size: 1.13rem;
      color: #5d426d;
      margin-bottom: 1.6rem;
      font-family: var(--font-main);
      text-align: center;
      padding: 0 10px;
    }
    .gift-btn {
      margin-top: 1.4rem;
      padding: 12px 34px;
      font-family: var(--font-script);
      background: linear-gradient(90deg, #e6428c, #ffa9df 90%);
      border: none; border-radius: 21px;
      color: #fff;
      font-size: 1.36rem;
      box-shadow: 0 6px 32px var(--color-shadow);
      cursor: pointer;
      letter-spacing: 0.7px;
      transition: background .23s, transform .15s;
      position: relative;
      z-index: 1;
    }
    .gift-btn:hover {
      background: linear-gradient(90deg, #ffa9df 15%, #e6428c 100%);
      transform: scale(1.04);
    }
    .digital-gift {
      background: #fffbedf3;
      border: 2px dashed #e678be88;
      border-radius: 10px;
      margin: 22px auto 0 auto;
      max-width: 420px;
      padding: 36px 14px 28px 14px;
      color: #d74185;
      font-family: var(--font-script);
      font-size: 1.36rem;
      box-shadow: 0 4px 18px #eab7d844;
      display: none;
    }

    /* Common Animations */
    @keyframes fadeInDown {
      0% {opacity: 0; transform: translateY(-40px);}
      100% {opacity: 1; transform: translateY(0);}
    }
    @keyframes fadeInUp {
      0% {opacity: 0; transform: translateY(50px);}
      100% {opacity: 1; transform: translateY(0);}
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    /* Responsive */
    @media (max-width: 650px) {
      .main-title { font-size: 2.13rem;}
      .section-title { font-size: 1.65rem;}
      .gallery-wrap {gap: 18px;}
      .polaroid {width: 140px;}
      .polaroid-img {width: 135px; height: 145px;}
      .letter-container, .parchment-bg, .moments-timeline {padding: 18px 7vw;}
      .final-card {padding: 24px 5vw;}
      .future-box, .short-quotes {padding: 18px 4vw;}
    }
    /* Decorative sparkles and hearts above everything else */
    .sparkles, .hearts {
      pointer-events: none;
      z-index: 1500;
      mix-blend-mode: screen;
      opacity: 0.77;
    }
    .confetti {
      pointer-events: none;
      z-index: 1950;
      position: absolute;
      top: 0; left: 0; width: 100vw; height: 100vh;
      pointer-events: none;
    }
  </style>
</head>
<body>
  <audio id="bg-music" autoplay loop>
    <source src="https://cdn.pixabay.com/audio/2022/10/16/audio_128b0c4d3b.mp3" type="audio/mp3">
    <!-- Royalty-free gentle background music, will autoplay if browser allows -->
  </audio>
  <div class="app-container" id="app-root"></div>
  <canvas class="sparkles" id="sparkle-canvas"></canvas>
  <canvas class="hearts" id="heart-canvas"></canvas>
  <canvas class="confetti" id="confetti-canvas" style="display:none"></canvas>
  <script>
    // --------- App Structure ---------
    const appRoot = document.getElementById('app-root');
    let state = {page: 0, showGift: false};

    function render() {
      appRoot.innerHTML = '';
      if (state.page === 0) {
        appRoot.appendChild(welcomePage());
      } else if (state.page === 1) {
        appRoot.appendChild(photoGalleryPage());
      } else if (state.page === 2) {
        appRoot.appendChild(loveLetterPage());
      } else if (state.page === 3) {
        appRoot.appendChild(momentsPage());
      } else if (state.page === 4) {
        appRoot.appendChild(finalBirthdayPage());
      }
    }
    // --------- 1. Welcome Page ---------
    function welcomePage() {
      const wrap = document.createElement('div');
      wrap.className = 'center-content';
      wrap.innerHTML = `
        <div class="main-title">Welcome, My Love</div>
        <div class="subtitle">
          A birthday journey made just for you.
        </div>
        <button class="primary-btn" id="start-btn">Enter Your Birthday Surprise ‚ù§Ô∏è</button>
      `;
      setTimeout(() => {
        document.getElementById('start-btn').focus();
      }, 800);
      wrap.querySelector('#start-btn').onclick = () => {
        transitionTo(1);
      };
      return wrap;
    }

    // --------- 2. Photo Gallery Page ---------
    const galleryPhotos = [
      {src: 'IMG-20251201-WA0043.jpg', cap: "My sunshine"},
      {src: 'IMG-20251201-WA0045.jpg', cap: "The smile I fall for every day"},
      {src: 'IMG-20251201-WA0046.jpg', cap: "My favorite person in the world"},
      {src: 'IMG-20251201-WA0047.jpg', cap: "Joy in her eyes"},
      {src: 'IMG-20251201-WA0048.jpg', cap: "Captured laughter"},
      {src: 'IMG-20251201-WA0049.jpg', cap: "The one I love"},
      {src: 'IMG-20251201-WA0050.jpg', cap: "my pretty little baby"},
      {src: 'IMG-20251201-WA0051.jpg', cap: "üòòüòòüòòüòòüòò"},
    ]; // Replace with her real photos later
    function photoGalleryPage() {
      const bg = document.createElement('div');
      bg.className = 'gallery-bg';
      const wrap = document.createElement('div');
      wrap.className = 'gallery-wrap';
      galleryPhotos.forEach(ph => {
        let pol = document.createElement('div');
        pol.className = 'polaroid';
        pol.innerHTML = `
          <img src="${ph.src}" alt="${ph.cap}" class="polaroid-img" />
          <div class="caption">${ph.cap}</div>
        `;
        wrap.appendChild(pol);
      });
      bg.appendChild(wrap);
      // Nav button
      const btn = navButton("Next: Read Your Letter üíå", 2);
      btn.style.marginTop = "32px";
      btn.style.marginBottom = "40px";
      bg.appendChild(btn);
      return bg;
    }

    // --------- 3. Love Letter Page ---------
    const love_letter_text = `My Love,

From the moment you came into my life, everything began to feel good, right, and more beautiful. You brought a happiness into my world that I love the most. With your smile, your warmth, and your gentle heart, you turned ordinary days into memories I hold close. Being with you feels special to me as no matter what we do I am always happy and thankfull to have you in my life.

What I feel for you is more than love‚Äîit‚Äôs admiration, respect, and a deep appreciation for the person you are. I adore the way you think, the way you laugh, and the way your presence can change my mood. I love your cute fights, that little < gussa hu me > and my most favourite < mujhe baat nai karni >. You make me want to grow, to become better, to be someone who deserves the kind of love you give so effortlessly.

No matter where I am or what I‚Äôm doing, you stay in my thoughts. I think of our memories, our little moments, our dreams. You‚Äôre not just someone I love‚Äîyou‚Äôre the person my heart chose, without hesitation and without doubt. And I will keep choosing you, in every season and every chapter of life.

I also wanna say that I never gonna giveup on you. I will always make you happy. I will love you till the last breath I have.

With all my love, always.
I am all yours.`;

    function loveLetterPage() {
      const page = document.createElement('div');
      page.className = 'letter-page';
      let letter = document.createElement('div');
      letter.className = 'letter-container';
      letter.innerHTML = `
        <div class="section-title" style="color:#a75be4">From My Heart to Yours</div>
        <div class="parchment-bg">
          <div class="love-letter" id="love-letter-typing"></div>
        </div>
      `;
      // Typed animation for letter
      setTimeout(() => {
        typedText("love-letter-typing", love_letter_text, 0, 20);
      }, 300);
      page.appendChild(letter);
      // Nav button
      const btn = navButton("Next: Our Moments &amp; Dreams üåô", 3);
      btn.style.marginTop = "38px";
      page.appendChild(btn);
      return page;
    }
    function typedText(id, text, i, delay) {
      const el = document.getElementById(id);
      if (el) {
        if (i > text.length) return;
        el.textContent = text.slice(0, i);
        setTimeout(() => typedText(id, text, i+1, delay), delay + (text[i]==='\n'?200:0));
      }
    }

    // --------- 4. Chosen Page: Our Moments & Dreams ---------
    const timelineEvents = [
      {date: "17 april", desc: "A Pic where all this start"},
      {date: "19 april", desc: "We meet inside collage and the weather which sets on its own"},
      {date: "18 may", desc: "Our first meet outside campus and the funniest date i had ever i can't forget that"},
      {date: "24 may", desc: "Our First Movie Date Where We Don't Watch Movie & We do our first kiss"},
      {date: "26 june", desc: "our First hug"},
      {date: "4 july", desc: "our first rain together"},
      // Replace or add more real memories!
    ];
    const shortQuotes = [
      "kuch essi teri muskurahat hai",
      "jese is kayanat ki shururat hai",
      "kuch essi teri akhen hai",
      "samundra se gehri nazar atti hai",
    ];
    const futureDreams = [
      "We will live together soon.",
      "Promise to always make you smile.",
      "Grow old with you, side by side.",
      "Make each tomorrow a little happier for us both wtb (little naughty also).",
      "I will never stop teaseing you my kiddo. ",
    ];

    function momentsPage() {
      const bg = document.createElement('div');
      bg.className = 'timeline-bg';
      bg.innerHTML = `<div class="section-title">Our Moments &amp; Future Dreams</div>`;
      // Timeline
      const timeline = document.createElement('div');
      timeline.className = 'moments-timeline';
      timelineEvents.forEach(e => {
        let ev = document.createElement('div');
        ev.className = 'timeline-event';
        ev.innerHTML = `<div class="timeline-dot"></div>
          <div class="event-date">${e.date}</div>
          <div class="event-desc">${e.desc}</div>`;
        timeline.appendChild(ev);
      });
      bg.appendChild(timeline);
      // Quotes
      const quoteBox = document.createElement('div');
      quoteBox.className = 'short-quotes';
      quoteBox.innerHTML = shortQuotes.map(q => `<div>${q}</div>`).join('<hr style="border:0;border-top:1px dashed #ffc9ee90;margin:14px 28px;">');
      bg.appendChild(quoteBox);
      // Future section
      const futBox = document.createElement('div');
      futBox.className = 'future-box';
      futBox.innerHTML = "<b>Our Future</b><br>" + futureDreams.map(d => `&#10022; ${d}`).join('<br>');
      bg.appendChild(futBox);
      // Navigation
      const btn = navButton("Final: Happy Birthday üéâ", 4);
      btn.style.marginTop = "40px";
      bg.appendChild(btn);
      return bg;
    }

    // --------- 5. Final Birthday Page: Celebration ---------
    function finalBirthdayPage() {
      const bg = document.createElement('div');
      bg.className = 'final-bg';
      const card = document.createElement('div');
      card.className = 'final-card';
      card.innerHTML = `
        <div class="final-title">Happy Birthday, My Love ‚ù§Ô∏è</div>
        <div class="final-note">
          You are my greatest blessing I have .<br><br>
          Wishing you a birthday as beautiful, bright, and magical as your soul.<br>
          May your dreams come true and every day bring you joy.<br>
          <span style="color:#e6428c;font-family:var(--font-script)">With all my love, forever.</span>
        </div>
        <button class="gift-btn" id="reveal-gift-btn">Reveal Your Digital Gift</button>
        <div class="digital-gift" id="digital-gift"></div>
      `;
      bg.appendChild(card);
      setTimeout(() => {
        document.getElementById('reveal-gift-btn').focus();
      }, 1000);
      // Reveal gift
      card.querySelector('#reveal-gift-btn').onclick = () => {
        state.showGift = true;
        showDigitalGift();
      };
      if (state.showGift) {
        setTimeout(showDigitalGift, 50);
      }
      // Confetti burst
      setTimeout(celebrateWithConfetti, 200);
      return bg;
    }

    function navButton(text, nextPage) {
      let btn = document.createElement("button");
      btn.className = "primary-btn";
      btn.textContent = text;
      btn.onclick = () => {
        transitionTo(nextPage);
      }
      return btn;
    }
    function transitionTo(pageNum) {
      state.page = pageNum;
      window.scrollTo({top: 0, behavior: 'smooth'});
      if (pageNum < 4) { // Remove gift/confetti state if going back
        state.showGift = false;
        document.getElementById('confetti-canvas').style.display = "none";
      }
      render();
    }

    // --------- Decorative/Animated Backgrounds ---------
    // Sparkle animation for Welcome/final pages
    function animateSparkles() {
      const canvas = document.getElementById('sparkle-canvas');
      const ctx = canvas.getContext('2d');
      let width = window.innerWidth, height = window.innerHeight;
      function resize() {
        canvas.width = width = window.innerWidth;
        canvas.height = height = window.innerHeight;
      }
      resize();
      window.addEventListener('resize', resize);

      let sparkles = [];
      for (let i = 0; i < 40; i++) {
        sparkles.push({
          x: Math.random()*width,
          y: Math.random()*height,
          r: 1.7+Math.random()*1.8,
          speed: 0.19+Math.random()*0.13,
          alpha: 0.45+Math.random()*0.49,
        });
      }
      function draw() {
        ctx.clearRect(0, 0, width, height);
        for (let s of sparkles) {
          ctx.save();
          ctx.globalAlpha = s.alpha;
          let grad = ctx.createRadialGradient(s.x, s.y, 0.7, s.x, s.y, s.r);
          grad.addColorStop(0, "#fff7fa");
          grad.addColorStop(0.6, "#ffe3eb");
          grad.addColorStop(1, "#fcbefc00");
          ctx.fillStyle = grad;
          ctx.beginPath();
          ctx.arc(s.x, s.y, s.r, 0, 2 * Math.PI, false);
          ctx.fill();
          ctx.restore();
          // Move
          s.y += s.speed;
          if (s.y > height+18) { s.y = -10; s.x = Math.random()*width; }
        }
        requestAnimationFrame(draw);
      }
      draw();
    }
    animateSparkles();

    // Gentle falling hearts background on Welcome/Final
    function animateHearts() {
      const canvas = document.getElementById('heart-canvas');
      const ctx = canvas.getContext('2d');
      let width = window.innerWidth, height = window.innerHeight;
      function resize() {
        canvas.width = width = window.innerWidth;
        canvas.height = height = window.innerHeight;
      }
      resize();
      window.addEventListener('resize', resize);

      function makeHeart() {
        return {
          x: Math.random()*width,
          y: Math.random()*-height,
          size: 26+20*Math.random(),
          speed: 0.4+0.13*Math.random(),
          osc: Math.random()*2*Math.PI,
        }
      }
      let hearts = new Array(16).fill(0).map(makeHeart);
      function drawOneHeart(x, y, s) {
        ctx.save();
        ctx.beginPath();
        let r = s/2.8;
        ctx.moveTo(x, y+r);
        ctx.bezierCurveTo(x, y, x-s/2, y-r, x, y-s/1.32);
        ctx.bezierCurveTo(x, y-s/1.32, x+s/2, y-r, x, y+r);
        ctx.fillStyle = "#f7bedfbb";
        ctx.shadowColor = "#eea5cb";
        ctx.shadowBlur = 7.3;
        ctx.fill();
        ctx.restore();
      }
      function draw() {
        ctx.clearRect(0, 0, width, height);
        for (let h of hearts) {
          drawOneHeart(h.x + Math.sin(h.y/22)*13, h.y, h.size);
          h.y += h.speed;
          h.x += Math.cos(h.osc+h.y/86)* 0.42;
          if (h.y > height+20) {
            Object.assign(h, makeHeart());
            h.y = Math.random()*-42;
          }
        }
        requestAnimationFrame(draw);
      }
      draw();
    }
    animateHearts();

    // Confetti celebration for final page
    function celebrateWithConfetti() {
      const canvas = document.getElementById('confetti-canvas');
      canvas.style.display = (state.page === 4) ? "block" : "none";
      if (state.page !== 4) return;
      let ctx = canvas.getContext('2d');
      let width = window.innerWidth, height = window.innerHeight;
      function resize() {
        canvas.width = width = window.innerWidth;
        canvas.height = height = window.innerHeight;
      }
      resize();
      window.addEventListener('resize', resize);

      // Confetti particles
      let colors = ["#ffa5d8","#fdeea9","#ffd1ff","#fbe5e9","#c5dffc","#f8d5e1","#e678be"];
      let confetti = [];
      for (let i=0; i<56; ++i)
        confetti.push({
          x: Math.random()*width,
          y: Math.random()*height*0.5,
          r: 6+10*Math.random(),
          d: 25+Math.random()*22,
          color: colors[Math.floor(Math.random()*colors.length)],
          tilt: Math.random()*7,
          tiltAngle: 0,
          speed: 1.3+Math.random()*1.1,
        });
      function draw() {
        ctx.clearRect(0,0,width,height);
        for (let c of confetti) {
          ctx.save();
          ctx.beginPath();
          ctx.ellipse(
            c.x, c.y,
            c.r, c.r*0.45, c.tilt, 0, 2*Math.PI);
          ctx.fillStyle = c.color;
          ctx.globalAlpha = 0.77;
          ctx.shadowColor = c.color;
          ctx.shadowBlur = 12;
          ctx.fill();
          ctx.restore();

          // Move
          c.y += c.speed;
          c.x += Math.sin(c.tilt)*2.1;
          c.tilt += 0.015 + Math.random()*0.013;
          c.tiltAngle += 0.07;
          if (c.y > height+24) {
            c.x = Math.random()*width;
            c.y = -12;
          }
        }
        if(state.page === 4)
          requestAnimationFrame(draw);
      }
      draw();
    }

    // --------- Digital Gift Reveal ---------
    function showDigitalGift() {
      const giftDiv = document.getElementById('digital-gift');
      if (!giftDiv) return;
      giftDiv.style.display = "block";
      giftDiv.innerHTML =
       "üéÅ <b>Digital Gift:</b> Ye lo digital kisses üòòüòòüòòüòòüòòüòòüòòüòòüòòüòòüòòüòòüòòüòòüòòüòòüòòüòòüòòüòòüòòüòòüòòüòòüòòüòò <br> And a shower of love, always ‚ù§Ô∏èüíñ";
      // Hearts burst
      burstHearts(15);
      // Hide button
      const btn = document.getElementById('reveal-gift-btn');
      if(btn) btn.style.display = "none";
    }
    function burstHearts(count) {
      // Draw burst of hearts around the digital gift
      const giftDiv = document.getElementById('digital-gift');
      if (!giftDiv) return;
      for (let i=0; i<count; i++) {
        let heart = document.createElement('span');
        heart.textContent = 'üíñ';
        heart.style.position = 'absolute';
        heart.style.left = `${40 + Math.random() * 220}px`;
        heart.style.top = `${60 + Math.random() * 50}px`;
        heart.style.fontSize = `${30 + Math.random() * 25}px`;
        heart.style.opacity = '1';
        heart.style.transition = 'all 1.3s cubic-bezier(.18,1.5,.42,1)';
        heart.style.pointerEvents = 'none';
        giftDiv.appendChild(heart);
        setTimeout(() => {
          heart.style.transform = `translateY(-${60+Math.random()*60}px) scale(${1+Math.random()*0.2})`;
          heart.style.opacity = '0';
        }, 70 + i*33);
        setTimeout(() => { if(heart.parentNode) giftDiv.removeChild(heart); }, 1500+i*33);
      }
    }

    // --------- Music Controls (optional) ---------
    (function setupMusic() {
      const music = document.getElementById('bg-music');
      if (music) {
        music.volume = 0.13;
        // Allow manually unmute
        window.addEventListener('keydown', (e) => {
          if ((e.key === 'm' || e.key === 'M') && music.paused) { music.play(); }
        });
      }
    })();

    // --------- Initialization ---------
    render();
  </script>
</body>
</html>
